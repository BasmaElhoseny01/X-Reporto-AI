2024-02-23 21:14:35 - INFO - =================== New Run Started: 2024-02-23 21:14:35 ===================
2024-02-23 21:14:35 - INFO -  X_Reporto Started
2024-02-23 21:14:35 - INFO - MODEL_STAGE: 1
2024-02-23 21:14:35 - INFO - DEVICE: cuda
2024-02-23 21:14:35 - INFO - CONTINUE_TRAIN: False
2024-02-23 21:14:35 - INFO - TRAIN_RPN: True
2024-02-23 21:14:35 - INFO - RUN: 0
2024-02-23 21:14:35 - INFO - EPOCHS: 5
2024-02-23 21:14:35 - INFO - BATCH_SIZE: 1
2024-02-23 21:14:35 - INFO - LM_Batch_Size: 1
2024-02-23 21:14:35 - INFO - LEARNING_RATE: 0.0001
2024-02-23 21:14:35 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 21:14:35 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 21:14:35 - INFO - DEBUG: True
2024-02-23 21:14:35 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 21:14:35 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 21:14:35 - INFO - training_csv_path: datasets/train.csv
2024-02-23 21:14:35 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 21:14:35 - INFO - PERIODIC_LOGGING: False
2024-02-23 21:14:35 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 21:14:37 - INFO - Loading object_detector [Trained RPN]....
2024-02-23 21:14:46 - INFO - Train dataset loaded
2024-02-23 21:14:46 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 21:14:46 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 21:14:46 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 150, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 141, in main
    validator.validate()
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'XReportoValidation' object has no attribute 'validate'
2024-02-23 21:16:02 - INFO - =================== New Run Started: 2024-02-23 21:16:02 ===================
2024-02-23 21:16:02 - INFO -  X_Reporto Started
2024-02-23 21:16:02 - INFO - MODEL_STAGE: 1
2024-02-23 21:16:02 - INFO - DEVICE: cuda
2024-02-23 21:16:02 - INFO - CONTINUE_TRAIN: False
2024-02-23 21:16:02 - INFO - TRAIN_RPN: True
2024-02-23 21:16:02 - INFO - RUN: 0
2024-02-23 21:16:02 - INFO - EPOCHS: 5
2024-02-23 21:16:02 - INFO - BATCH_SIZE: 1
2024-02-23 21:16:02 - INFO - LM_Batch_Size: 1
2024-02-23 21:16:02 - INFO - LEARNING_RATE: 0.0001
2024-02-23 21:16:02 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 21:16:02 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 21:16:02 - INFO - DEBUG: True
2024-02-23 21:16:02 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 21:16:02 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 21:16:02 - INFO - training_csv_path: datasets/train.csv
2024-02-23 21:16:02 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 21:16:02 - INFO - PERIODIC_LOGGING: False
2024-02-23 21:16:02 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 21:16:04 - INFO - Loading object_detector [Trained RPN]....
2024-02-23 21:16:14 - INFO - Train dataset loaded
2024-02-23 21:16:14 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 21:16:14 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 21:16:15 - INFO - Start Validation
2024-02-23 21:16:38 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 150, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 141, in main
    validator.Validate()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 46, in Validate
    for batch_idx,(images,object_detector_targets,selection_classifier_targets,abnormal_classifier_targets,LM_inputs,LM_targets) in enumerate(self.data_loader_val):
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\utils\data\dataloader.py", line 630, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\utils\data\dataloader.py", line 1345, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\utils\data\dataloader.py", line 1371, in _process_data
    data.reraise()
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\_utils.py", line 694, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\utils\data\_utils\fetch.py", line 54, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
TypeError: CustomDataset.collate_fn() missing 1 required positional argument: 'batch'

2024-02-23 21:20:50 - INFO - =================== New Run Started: 2024-02-23 21:20:50 ===================
2024-02-23 21:20:50 - INFO -  X_Reporto Started
2024-02-23 21:20:50 - INFO - MODEL_STAGE: 1
2024-02-23 21:20:50 - INFO - DEVICE: cuda
2024-02-23 21:20:50 - INFO - CONTINUE_TRAIN: False
2024-02-23 21:20:50 - INFO - TRAIN_RPN: True
2024-02-23 21:20:50 - INFO - RUN: 0
2024-02-23 21:20:50 - INFO - EPOCHS: 5
2024-02-23 21:20:50 - INFO - BATCH_SIZE: 1
2024-02-23 21:20:50 - INFO - LM_Batch_Size: 1
2024-02-23 21:20:50 - INFO - LEARNING_RATE: 0.0001
2024-02-23 21:20:50 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 21:20:50 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 21:20:50 - INFO - DEBUG: True
2024-02-23 21:20:50 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 21:20:50 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 21:20:50 - INFO - training_csv_path: datasets/train.csv
2024-02-23 21:20:50 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 21:20:50 - INFO - PERIODIC_LOGGING: False
2024-02-23 21:20:50 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 21:20:52 - INFO - Loading object_detector [Trained RPN]....
2024-02-23 21:21:01 - INFO - Train dataset loaded
2024-02-23 21:21:01 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 21:21:11 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 21:21:12 - INFO - Start Validation
2024-02-23 21:21:51 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 192, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 183, in main
    validator.Validate()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 65, in Validate
    Total_loss=self.object_detector_and_classifier_forward_pass(batch_idx=batch_idx,images=images,object_detector_targets=object_detector_targets,selection_classifier_targets=selection_classifier_targets,abnormal_classifier_targets=abnormal_classifier_targets)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\validation\x_reporto_validation.py", line 104, in object_detector_and_classifier_forward_pass
    object_detector_losses,selection_classifier_losses,abnormal_binary_classifier_losses,LM_losses= self.model(images,None,None, object_detector_targets ,selection_classifier_targets,abnormal_classifier_targets,None)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 4, got 3)
2024-02-23 21:35:44 - INFO - =================== New Run Started: 2024-02-23 21:35:44 ===================
2024-02-23 21:35:44 - INFO -  X_Reporto Started
2024-02-23 21:35:44 - INFO - MODEL_STAGE: 1
2024-02-23 21:35:44 - INFO - DEVICE: cuda
2024-02-23 21:35:44 - INFO - CONTINUE_TRAIN: False
2024-02-23 21:35:44 - INFO - TRAIN_RPN: True
2024-02-23 21:35:44 - INFO - RUN: 0
2024-02-23 21:35:44 - INFO - EPOCHS: 5
2024-02-23 21:35:44 - INFO - BATCH_SIZE: 1
2024-02-23 21:35:44 - INFO - LM_Batch_Size: 1
2024-02-23 21:35:44 - INFO - LEARNING_RATE: 0.0001
2024-02-23 21:35:44 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 21:35:44 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 21:35:44 - INFO - DEBUG: True
2024-02-23 21:35:44 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 21:35:44 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 21:35:44 - INFO - training_csv_path: datasets/train.csv
2024-02-23 21:35:44 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 21:35:44 - INFO - PERIODIC_LOGGING: False
2024-02-23 21:35:44 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 21:35:46 - INFO - Loading object_detector [Trained RPN]....
2024-02-23 21:35:57 - INFO - Train dataset loaded
2024-02-23 21:35:57 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 21:35:58 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 21:35:58 - INFO - Start Validation
2024-02-23 21:36:39 - DEBUG - Batch 1/2 object_detector_Loss: 4.7442 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 4.7442
2024-02-23 21:36:41 - DEBUG - Batch 2/2 object_detector_Loss: 4.2164 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 4.2164
2024-02-23 21:36:43 - INFO - Vaildation Done
2024-02-23 21:42:47 - INFO - =================== New Run Started: 2024-02-23 21:42:47 ===================
2024-02-23 21:42:47 - INFO -  X_Reporto Started
2024-02-23 21:42:47 - INFO - MODEL_STAGE: 1
2024-02-23 21:42:47 - INFO - DEVICE: cuda
2024-02-23 21:42:47 - INFO - CONTINUE_TRAIN: True
2024-02-23 21:42:47 - INFO - TRAIN_RPN: True
2024-02-23 21:42:47 - INFO - RUN: 0
2024-02-23 21:42:47 - INFO - EPOCHS: 5
2024-02-23 21:42:47 - INFO - BATCH_SIZE: 1
2024-02-23 21:42:47 - INFO - LM_Batch_Size: 1
2024-02-23 21:42:47 - INFO - LEARNING_RATE: 0.0001
2024-02-23 21:42:47 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 21:42:47 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 21:42:47 - INFO - DEBUG: True
2024-02-23 21:42:47 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 21:42:47 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 21:42:47 - INFO - training_csv_path: datasets/train.csv
2024-02-23 21:42:47 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 21:42:47 - INFO - PERIODIC_LOGGING: False
2024-02-23 21:42:47 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 21:42:49 - INFO - Loading object_detector [Trained RPN] Validation....
2024-02-23 21:42:59 - INFO - Train dataset loaded
2024-02-23 21:42:59 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 21:43:00 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 21:43:00 - INFO - Start Validation
2024-02-23 21:43:33 - DEBUG - Batch 1/2 object_detector_Loss: 4.7126 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 4.7126
2024-02-23 21:43:35 - DEBUG - Batch 2/2 object_detector_Loss: 4.2085 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 4.2085
2024-02-23 21:43:37 - INFO - Vaildation Done
2024-02-23 21:47:33 - INFO - =================== New Run Started: 2024-02-23 21:47:33 ===================
2024-02-23 21:47:33 - INFO -  X_Reporto Started
2024-02-23 21:47:33 - INFO - MODEL_STAGE: 1
2024-02-23 21:47:33 - INFO - DEVICE: cuda
2024-02-23 21:47:33 - INFO - CONTINUE_TRAIN: True
2024-02-23 21:47:33 - INFO - TRAIN_RPN: True
2024-02-23 21:47:33 - INFO - RUN: 0
2024-02-23 21:47:33 - INFO - EPOCHS: 5
2024-02-23 21:47:33 - INFO - BATCH_SIZE: 1
2024-02-23 21:47:33 - INFO - LM_Batch_Size: 1
2024-02-23 21:47:33 - INFO - LEARNING_RATE: 0.0001
2024-02-23 21:47:33 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 21:47:33 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 21:47:33 - INFO - DEBUG: True
2024-02-23 21:47:33 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 21:47:33 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 21:47:33 - INFO - training_csv_path: datasets/train.csv
2024-02-23 21:47:33 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 21:47:33 - INFO - PERIODIC_LOGGING: False
2024-02-23 21:47:33 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 21:47:35 - INFO - Loading object_detector [Trained RPN] Validation....
2024-02-23 21:47:47 - INFO - Train dataset loaded
2024-02-23 21:47:47 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 21:47:47 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 21:47:47 - INFO - Start Validation
2024-02-23 21:48:29 - DEBUG - Batch 1/2 object_detector_Loss: 4.5932 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 4.5932
2024-02-23 21:48:30 - DEBUG - Batch 2/2 object_detector_Loss: 4.4287 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 4.4287
2024-02-23 21:48:36 - INFO - Vaildation Done
