2024-02-23 11:46:45 - INFO - =================== New Run Started: 2024-02-23 11:46:45 ===================
2024-02-23 11:46:45 - INFO - Tarning X_Reporto Started
2024-02-23 11:46:45 - INFO - MODEL_STAGE: 1
2024-02-23 11:46:45 - INFO - DEVICE: cuda
2024-02-23 11:46:45 - INFO - CONTINUE_TRAIN: False
2024-02-23 11:46:45 - INFO - TRAIN_RPN: True
2024-02-23 11:46:45 - INFO - RUN: 0
2024-02-23 11:46:45 - INFO - EPOCHS: 5
2024-02-23 11:46:45 - INFO - BATCH_SIZE: 32
2024-02-23 11:46:45 - INFO - LM_Batch_Size: 1
2024-02-23 11:46:45 - INFO - LEARNING_RATE: 0.0001
2024-02-23 11:46:45 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 11:46:45 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 11:46:45 - INFO - DEBUG: True
2024-02-23 11:46:45 - INFO - GENERATE_REPORT: False
2024-02-23 11:46:45 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 11:46:45 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 11:46:45 - INFO - training_csv_path: datasets/train.csv
2024-02-23 11:46:45 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 11:46:45 - INFO - PERIODIC_LOGGING: False
2024-02-23 11:46:45 - INFO - Folder 'models/0' already exists.
2024-02-23 11:47:21 - INFO - =================== New Run Started: 2024-02-23 11:47:21 ===================
2024-02-23 11:47:21 - INFO - Tarning X_Reporto Started
2024-02-23 11:47:21 - INFO - MODEL_STAGE: 1
2024-02-23 11:47:21 - INFO - DEVICE: cuda
2024-02-23 11:47:21 - INFO - CONTINUE_TRAIN: False
2024-02-23 11:47:21 - INFO - TRAIN_RPN: True
2024-02-23 11:47:21 - INFO - RUN: 0
2024-02-23 11:47:21 - INFO - EPOCHS: 5
2024-02-23 11:47:21 - INFO - BATCH_SIZE: 32
2024-02-23 11:47:21 - INFO - LM_Batch_Size: 1
2024-02-23 11:47:21 - INFO - LEARNING_RATE: 0.0001
2024-02-23 11:47:21 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 11:47:21 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 11:47:21 - INFO - DEBUG: True
2024-02-23 11:47:21 - INFO - GENERATE_REPORT: False
2024-02-23 11:47:21 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 11:47:21 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 11:47:21 - INFO - training_csv_path: datasets/train.csv
2024-02-23 11:47:21 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 11:47:21 - INFO - PERIODIC_LOGGING: False
2024-02-23 11:47:21 - INFO - Folder 'models/0' already exists.
2024-02-23 11:47:28 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 11:47:29 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 11:47:29 - DEBUG - Attempting to acquire lock 2256455263296 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\be4d21d94f3b4687e5a54d84bf6ab46ed0f8defd.lock
2024-02-23 11:47:29 - DEBUG - Lock 2256455263296 acquired on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\be4d21d94f3b4687e5a54d84bf6ab46ed0f8defd.lock
2024-02-23 11:47:30 - DEBUG - https://huggingface.co:443 "GET /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 26
2024-02-23 11:47:30 - DEBUG - Attempting to release lock 2256455263296 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\be4d21d94f3b4687e5a54d84bf6ab46ed0f8defd.lock
2024-02-23 11:47:30 - DEBUG - Lock 2256455263296 released on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\be4d21d94f3b4687e5a54d84bf6ab46ed0f8defd.lock
2024-02-23 11:47:30 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/vocab.json HTTP/1.1" 200 0
2024-02-23 11:47:30 - DEBUG - Attempting to acquire lock 2256455262432 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\b00361fece0387ca34b4b8b8539ed830d644dbeb.lock
2024-02-23 11:47:30 - DEBUG - Lock 2256455262432 acquired on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\b00361fece0387ca34b4b8b8539ed830d644dbeb.lock
2024-02-23 11:47:31 - DEBUG - https://huggingface.co:443 "GET /healx/gpt-2-pubmed-medium/resolve/main/vocab.json HTTP/1.1" 200 898669
2024-02-23 11:47:35 - DEBUG - Attempting to release lock 2256455262432 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\b00361fece0387ca34b4b8b8539ed830d644dbeb.lock
2024-02-23 11:47:35 - DEBUG - Lock 2256455262432 released on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\b00361fece0387ca34b4b8b8539ed830d644dbeb.lock
2024-02-23 11:47:35 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/merges.txt HTTP/1.1" 200 0
2024-02-23 11:47:35 - DEBUG - Attempting to acquire lock 2256455262816 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\226b0752cac7789c48f0cb3ec53eda48b7be36cc.lock
2024-02-23 11:47:35 - DEBUG - Lock 2256455262816 acquired on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\226b0752cac7789c48f0cb3ec53eda48b7be36cc.lock
2024-02-23 11:47:36 - DEBUG - https://huggingface.co:443 "GET /healx/gpt-2-pubmed-medium/resolve/main/merges.txt HTTP/1.1" 200 456318
2024-02-23 11:47:38 - DEBUG - Attempting to release lock 2256455262816 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\226b0752cac7789c48f0cb3ec53eda48b7be36cc.lock
2024-02-23 11:47:38 - DEBUG - Lock 2256455262816 released on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\226b0752cac7789c48f0cb3ec53eda48b7be36cc.lock
2024-02-23 11:47:38 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/added_tokens.json HTTP/1.1" 404 0
2024-02-23 11:47:38 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/special_tokens_map.json HTTP/1.1" 200 0
2024-02-23 11:47:38 - DEBUG - Attempting to acquire lock 2256455262048 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\817762d631ad6f9c799f6b9dc713c46420e65546.lock
2024-02-23 11:47:38 - DEBUG - Lock 2256455262048 acquired on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\817762d631ad6f9c799f6b9dc713c46420e65546.lock
2024-02-23 11:47:39 - DEBUG - https://huggingface.co:443 "GET /healx/gpt-2-pubmed-medium/resolve/main/special_tokens_map.json HTTP/1.1" 200 90
2024-02-23 11:47:39 - DEBUG - Attempting to release lock 2256455262048 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\817762d631ad6f9c799f6b9dc713c46420e65546.lock
2024-02-23 11:47:39 - DEBUG - Lock 2256455262048 released on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\817762d631ad6f9c799f6b9dc713c46420e65546.lock
2024-02-23 11:47:39 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer.json HTTP/1.1" 404 0
2024-02-23 11:47:39 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 11:47:39 - DEBUG - Attempting to acquire lock 2256455262816 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\820cf16cc8c4c6ef3b0b8740e68622fb8bcf4723.lock
2024-02-23 11:47:39 - DEBUG - Lock 2256455262816 acquired on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\820cf16cc8c4c6ef3b0b8740e68622fb8bcf4723.lock
2024-02-23 11:47:39 - DEBUG - https://huggingface.co:443 "GET /healx/gpt-2-pubmed-medium/resolve/main/config.json HTTP/1.1" 200 651
2024-02-23 11:47:39 - DEBUG - Attempting to release lock 2256455262816 on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\820cf16cc8c4c6ef3b0b8740e68622fb8bcf4723.lock
2024-02-23 11:47:39 - DEBUG - Lock 2256455262816 released on C:\Users\Dell\.cache\huggingface\hub\.locks\models--healx--gpt-2-pubmed-medium\820cf16cc8c4c6ef3b0b8740e68622fb8bcf4723.lock
2024-02-23 11:47:39 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 836, in <module>
    main()
  File "D:\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 820, in main
    trainer = XReportoTrainer(model=x_reporto_model)
  File "D:\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 102, in __init__
    self.dataset_train = CustomDataset(dataset_path= training_csv_path, transform_type='train',tokenizer=self.tokenizer)
  File "D:\Graduation-Project\src\x_reporto\data_loader\custom_dataset.py", line 24, in __init__
    self.transform = CustomAugmentation(transform_type=self.transform_type)
  File "D:\Graduation-Project\src\object_detector\data_loader\custom_augmentation.py", line 29, in __init__
    self.transform=TransformLibrary(transform_type)
  File "D:\Graduation-Project\src\object_detector\data_loader\custom_augmentation.py", line 53, in __init__
    A.Affine(mode=cv2.BORDER_CONSTANT, cval=0, rotate=(-ANGLE, ANGLE),keep_ratio=True),
TypeError: Affine.__init__() got an unexpected keyword argument 'keep_ratio'
2024-02-23 11:48:55 - INFO - =================== New Run Started: 2024-02-23 11:48:55 ===================
2024-02-23 11:48:55 - INFO - Tarning X_Reporto Started
2024-02-23 11:48:55 - INFO - MODEL_STAGE: 1
2024-02-23 11:48:55 - INFO - DEVICE: cuda
2024-02-23 11:48:55 - INFO - CONTINUE_TRAIN: False
2024-02-23 11:48:55 - INFO - TRAIN_RPN: True
2024-02-23 11:48:55 - INFO - RUN: 0
2024-02-23 11:48:55 - INFO - EPOCHS: 5
2024-02-23 11:48:55 - INFO - BATCH_SIZE: 32
2024-02-23 11:48:55 - INFO - LM_Batch_Size: 1
2024-02-23 11:48:55 - INFO - LEARNING_RATE: 0.0001
2024-02-23 11:48:55 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 11:48:55 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 11:48:55 - INFO - DEBUG: True
2024-02-23 11:48:55 - INFO - GENERATE_REPORT: False
2024-02-23 11:48:55 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 11:48:55 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 11:48:55 - INFO - training_csv_path: datasets/train.csv
2024-02-23 11:48:55 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 11:48:55 - INFO - PERIODIC_LOGGING: False
2024-02-23 11:48:55 - INFO - Folder 'models/0' already exists.
2024-02-23 11:49:01 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 11:49:01 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 11:49:01 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 836, in <module>
    main()
  File "D:\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 820, in main
    trainer = XReportoTrainer(model=x_reporto_model)
  File "D:\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 102, in __init__
    self.dataset_train = CustomDataset(dataset_path= training_csv_path, transform_type='train',tokenizer=self.tokenizer)
  File "D:\Graduation-Project\src\x_reporto\data_loader\custom_dataset.py", line 24, in __init__
    self.transform = CustomAugmentation(transform_type=self.transform_type)
  File "D:\Graduation-Project\src\object_detector\data_loader\custom_augmentation.py", line 29, in __init__
    self.transform=TransformLibrary(transform_type)
  File "D:\Graduation-Project\src\object_detector\data_loader\custom_augmentation.py", line 53, in __init__
    A.Affine(mode=cv2.BORDER_CONSTANT, cval=0, rotate=(-ANGLE, ANGLE),keep_ratio=True),
TypeError: Affine.__init__() got an unexpected keyword argument 'keep_ratio'
2024-02-23 14:03:20 - INFO - =================== New Run Started: 2024-02-23 14:03:20 ===================
2024-02-23 14:03:20 - INFO - Tarning X_Reporto Started
2024-02-23 14:03:20 - INFO - MODEL_STAGE: 1
2024-02-23 14:03:20 - INFO - DEVICE: cuda
2024-02-23 14:03:20 - INFO - CONTINUE_TRAIN: False
2024-02-23 14:03:20 - INFO - TRAIN_RPN: True
2024-02-23 14:03:20 - INFO - RUN: 0
2024-02-23 14:03:20 - INFO - EPOCHS: 5
2024-02-23 14:03:20 - INFO - BATCH_SIZE: 32
2024-02-23 14:03:20 - INFO - LM_Batch_Size: 1
2024-02-23 14:03:20 - INFO - LEARNING_RATE: 0.0001
2024-02-23 14:03:20 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 14:03:20 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 14:03:20 - INFO - DEBUG: True
2024-02-23 14:03:20 - INFO - GENERATE_REPORT: False
2024-02-23 14:03:20 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 14:03:20 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 14:03:20 - INFO - training_csv_path: datasets/train.csv
2024-02-23 14:03:20 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 14:03:20 - INFO - PERIODIC_LOGGING: False
2024-02-23 14:03:20 - INFO - Folder 'models/0' already exists.
2024-02-23 14:03:24 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 14:03:24 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 14:04:38 - INFO - =================== New Run Started: 2024-02-23 14:04:38 ===================
2024-02-23 14:04:38 - INFO - Tarning X_Reporto Started
2024-02-23 14:04:38 - INFO - MODEL_STAGE: 1
2024-02-23 14:04:38 - INFO - DEVICE: cuda
2024-02-23 14:04:38 - INFO - CONTINUE_TRAIN: False
2024-02-23 14:04:38 - INFO - TRAIN_RPN: True
2024-02-23 14:04:38 - INFO - RUN: 0
2024-02-23 14:04:38 - INFO - EPOCHS: 5
2024-02-23 14:04:38 - INFO - BATCH_SIZE: 1
2024-02-23 14:04:38 - INFO - LM_Batch_Size: 1
2024-02-23 14:04:38 - INFO - LEARNING_RATE: 0.0001
2024-02-23 14:04:38 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 14:04:38 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 14:04:38 - INFO - DEBUG: True
2024-02-23 14:04:38 - INFO - GENERATE_REPORT: False
2024-02-23 14:04:38 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 14:04:38 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 14:04:38 - INFO - training_csv_path: datasets/train.csv
2024-02-23 14:04:38 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 14:04:38 - INFO - PERIODIC_LOGGING: False
2024-02-23 14:04:38 - INFO - Folder 'models/0' already exists.
2024-02-23 14:04:41 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 14:04:42 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 14:51:25 - INFO - =================== New Run Started: 2024-02-23 14:51:25 ===================
2024-02-23 14:51:25 - INFO - Tarning X_Reporto Started
2024-02-23 14:51:25 - INFO - MODEL_STAGE: 3
2024-02-23 14:51:25 - INFO - DEVICE: cuda
2024-02-23 14:51:25 - INFO - CONTINUE_TRAIN: False
2024-02-23 14:51:25 - INFO - TRAIN_RPN: True
2024-02-23 14:51:25 - INFO - RUN: 0
2024-02-23 14:51:25 - INFO - EPOCHS: 5
2024-02-23 14:51:25 - INFO - BATCH_SIZE: 4
2024-02-23 14:51:25 - INFO - LM_Batch_Size: 1
2024-02-23 14:51:25 - INFO - LEARNING_RATE: 0.0001
2024-02-23 14:51:25 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 14:51:25 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 14:51:25 - INFO - DEBUG: True
2024-02-23 14:51:25 - INFO - GENERATE_REPORT: False
2024-02-23 14:51:25 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 14:51:25 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 14:51:25 - INFO - training_csv_path: datasets/train.csv
2024-02-23 14:51:25 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 14:51:25 - INFO - PERIODIC_LOGGING: False
2024-02-23 14:51:25 - INFO - Folder 'models/0' already exists.
2024-02-23 14:51:30 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 14:51:31 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:51:31 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:51:32 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/generation_config.json HTTP/1.1" 200 0
2024-02-23 14:51:34 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 14:51:44 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 817, in <module>
    main()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 805, in main
    trainer.train()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 125, in train
    for batch_idx,(images,object_detector_targets,selection_classifier_targets,abnormal_classifier_targets,LM_inputs,LM_targets) in enumerate(self.data_loader_train):
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\utils\data\dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\utils\data\dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\utils\data\dataloader.py", line 1372, in _process_data
    data.reraise()
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\_utils.py", line 722, in reraise
    raise exception
NameError: Caught NameError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 54, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 732, in collate_fn
    (object_detector_batch,selection_classifier_batch,abnormal_classifier_batch,LM_batch) = batch[k]
                                                                                                  ^
NameError: name 'k' is not defined

2024-02-23 14:52:15 - INFO - =================== New Run Started: 2024-02-23 14:52:15 ===================
2024-02-23 14:52:15 - INFO - Tarning X_Reporto Started
2024-02-23 14:52:15 - INFO - MODEL_STAGE: 3
2024-02-23 14:52:15 - INFO - DEVICE: cuda
2024-02-23 14:52:15 - INFO - CONTINUE_TRAIN: False
2024-02-23 14:52:15 - INFO - TRAIN_RPN: True
2024-02-23 14:52:15 - INFO - RUN: 0
2024-02-23 14:52:15 - INFO - EPOCHS: 5
2024-02-23 14:52:15 - INFO - BATCH_SIZE: 4
2024-02-23 14:52:15 - INFO - LM_Batch_Size: 1
2024-02-23 14:52:15 - INFO - LEARNING_RATE: 0.0001
2024-02-23 14:52:15 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 14:52:15 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 14:52:15 - INFO - DEBUG: True
2024-02-23 14:52:15 - INFO - GENERATE_REPORT: False
2024-02-23 14:52:15 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 14:52:15 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 14:52:15 - INFO - training_csv_path: datasets/train.csv
2024-02-23 14:52:15 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 14:52:15 - INFO - PERIODIC_LOGGING: False
2024-02-23 14:52:15 - INFO - Folder 'models/0' already exists.
2024-02-23 14:52:18 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 14:52:19 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:52:19 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:52:20 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/generation_config.json HTTP/1.1" 200 0
2024-02-23 14:52:23 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 14:52:42 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 817, in <module>
    main()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 805, in main
    trainer.train()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 151, in train
    object_detector_losses,selection_classifier_losses,abnormal_binary_classifier_losses,LM_losses,stop= self.model(images,input_ids,attention_mask, object_detector_targets,selection_classifier_targets,abnormal_classifier_targets,LM_targets,batch,i)
                                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\models\x_reporto_v1.py", line 289, in forward
    object_detector_detected_classes=object_detector_detected_classes.to(DEVICE)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'to'
2024-02-23 14:56:24 - INFO - =================== New Run Started: 2024-02-23 14:56:24 ===================
2024-02-23 14:56:24 - INFO - Tarning X_Reporto Started
2024-02-23 14:56:24 - INFO - MODEL_STAGE: 3
2024-02-23 14:56:24 - INFO - DEVICE: cuda
2024-02-23 14:56:24 - INFO - CONTINUE_TRAIN: False
2024-02-23 14:56:24 - INFO - TRAIN_RPN: False
2024-02-23 14:56:24 - INFO - RUN: 0
2024-02-23 14:56:24 - INFO - EPOCHS: 5
2024-02-23 14:56:24 - INFO - BATCH_SIZE: 4
2024-02-23 14:56:24 - INFO - LM_Batch_Size: 1
2024-02-23 14:56:24 - INFO - LEARNING_RATE: 0.0001
2024-02-23 14:56:24 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 14:56:24 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 14:56:24 - INFO - DEBUG: True
2024-02-23 14:56:24 - INFO - GENERATE_REPORT: False
2024-02-23 14:56:24 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 14:56:24 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 14:56:24 - INFO - training_csv_path: datasets/train.csv
2024-02-23 14:56:24 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 14:56:24 - INFO - PERIODIC_LOGGING: False
2024-02-23 14:56:24 - INFO - Folder 'models/0' already exists.
2024-02-23 14:56:27 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 14:56:28 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:56:28 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:56:29 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/generation_config.json HTTP/1.1" 200 0
2024-02-23 14:56:31 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 14:56:47 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 817, in <module>
    main()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 805, in main
    trainer.train()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 151, in train
    object_detector_losses,selection_classifier_losses,abnormal_binary_classifier_losses,LM_losses,stop= self.model(images,input_ids,attention_mask, object_detector_targets,selection_classifier_targets,abnormal_classifier_targets,LM_targets,batch,i)
                                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\models\x_reporto_v1.py", line 290, in forward
    selection_classifier_losses,_,_=self.binary_classifier_selection_region(object_detector_features,object_detector_detected_classes,selection_classifier_targets)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\binary_classifier\models\binary_classifier_selection_region_factory.py", line 60, in forward
    classifier_losses=self.selection_binary_classifier(object_detector_features,object_detector_detected_classes,selection_classifier_targets)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\binary_classifier\models\binary_classifier_selection_region_v1.py", line 71, in forward
    detected_region_has_sentence = region_has_sentence[class_detected]
                                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
IndexError: too many indices for tensor of dimension 1
2024-02-23 14:59:50 - INFO - =================== New Run Started: 2024-02-23 14:59:50 ===================
2024-02-23 14:59:50 - INFO - Tarning X_Reporto Started
2024-02-23 14:59:50 - INFO - MODEL_STAGE: 3
2024-02-23 14:59:50 - INFO - DEVICE: cuda
2024-02-23 14:59:50 - INFO - CONTINUE_TRAIN: False
2024-02-23 14:59:50 - INFO - TRAIN_RPN: False
2024-02-23 14:59:50 - INFO - RUN: 0
2024-02-23 14:59:50 - INFO - EPOCHS: 5
2024-02-23 14:59:50 - INFO - BATCH_SIZE: 4
2024-02-23 14:59:50 - INFO - LM_Batch_Size: 1
2024-02-23 14:59:50 - INFO - LEARNING_RATE: 0.0001
2024-02-23 14:59:50 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 14:59:50 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 14:59:50 - INFO - DEBUG: True
2024-02-23 14:59:50 - INFO - GENERATE_REPORT: False
2024-02-23 14:59:50 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 14:59:50 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 14:59:50 - INFO - training_csv_path: datasets/train.csv
2024-02-23 14:59:50 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 14:59:50 - INFO - PERIODIC_LOGGING: False
2024-02-23 14:59:50 - INFO - Folder 'models/0' already exists.
2024-02-23 14:59:53 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 14:59:54 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:59:54 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 14:59:55 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/generation_config.json HTTP/1.1" 200 0
2024-02-23 14:59:58 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 15:01:34 - INFO - =================== New Run Started: 2024-02-23 15:01:34 ===================
2024-02-23 15:01:34 - INFO - Tarning X_Reporto Started
2024-02-23 15:01:34 - INFO - MODEL_STAGE: 3
2024-02-23 15:01:34 - INFO - DEVICE: cuda
2024-02-23 15:01:34 - INFO - CONTINUE_TRAIN: True
2024-02-23 15:01:34 - INFO - TRAIN_RPN: False
2024-02-23 15:01:34 - INFO - RUN: 0
2024-02-23 15:01:34 - INFO - EPOCHS: 5
2024-02-23 15:01:34 - INFO - BATCH_SIZE: 4
2024-02-23 15:01:34 - INFO - LM_Batch_Size: 1
2024-02-23 15:01:34 - INFO - LEARNING_RATE: 0.0001
2024-02-23 15:01:34 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 15:01:34 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 15:01:34 - INFO - DEBUG: True
2024-02-23 15:01:34 - INFO - GENERATE_REPORT: False
2024-02-23 15:01:34 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 15:01:34 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 15:01:34 - INFO - training_csv_path: datasets/train.csv
2024-02-23 15:01:34 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 15:01:34 - INFO - PERIODIC_LOGGING: False
2024-02-23 15:01:34 - INFO - Folder 'models/0' already exists.
2024-02-23 15:01:37 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 15:01:38 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 15:01:38 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 15:01:39 - DEBUG - https://huggingface.co:443 "HEAD /gpt2/resolve/main/generation_config.json HTTP/1.1" 200 0
2024-02-23 15:01:42 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 817, in <module>
    main()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 798, in main
    x_reporto_model = XReporto().create_model()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\models\x_reporto_factory.py", line 8, in create_model
    return XReportoV1()
           ^^^^^^^^^^^^
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\models\x_reporto_v1.py", line 96, in __init__
    load_model(model=self.language_model,name='LM')
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\utils.py", line 285, in load_model
    model.load_state_dict(torch.load("models/" + str(RUN) + '/' + name + ".pth"))
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\nn\modules\module.py", line 2153, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for CustomGPT2:
	Unexpected key(s) in state_dict: "blocks.0.attn.w_o.weight", "blocks.0.attn.w_o.bias", "blocks.1.attn.w_o.weight", "blocks.1.attn.w_o.bias", "blocks.2.attn.w_o.weight", "blocks.2.attn.w_o.bias", "blocks.3.attn.w_o.weight", "blocks.3.attn.w_o.bias", "blocks.4.attn.w_o.weight", "blocks.4.attn.w_o.bias", "blocks.5.attn.w_o.weight", "blocks.5.attn.w_o.bias", "blocks.6.attn.w_o.weight", "blocks.6.attn.w_o.bias", "blocks.7.attn.w_o.weight", "blocks.7.attn.w_o.bias", "blocks.8.attn.w_o.weight", "blocks.8.attn.w_o.bias", "blocks.9.attn.w_o.weight", "blocks.9.attn.w_o.bias", "blocks.10.attn.w_o.weight", "blocks.10.attn.w_o.bias", "blocks.11.attn.w_o.weight", "blocks.11.attn.w_o.bias". 
2024-02-23 15:04:57 - INFO - =================== New Run Started: 2024-02-23 15:04:57 ===================
2024-02-23 15:04:57 - INFO - Tarning X_Reporto Started
2024-02-23 15:04:57 - INFO - MODEL_STAGE: 3
2024-02-23 15:04:57 - INFO - DEVICE: cuda
2024-02-23 15:04:57 - INFO - CONTINUE_TRAIN: False
2024-02-23 15:04:57 - INFO - TRAIN_RPN: False
2024-02-23 15:04:57 - INFO - RUN: 0
2024-02-23 15:04:57 - INFO - EPOCHS: 5
2024-02-23 15:04:57 - INFO - BATCH_SIZE: 4
2024-02-23 15:04:57 - INFO - LM_Batch_Size: 1
2024-02-23 15:04:57 - INFO - LEARNING_RATE: 0.0001
2024-02-23 15:04:57 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 15:04:57 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 15:04:57 - INFO - DEBUG: True
2024-02-23 15:04:57 - INFO - GENERATE_REPORT: False
2024-02-23 15:04:57 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 15:04:57 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 15:04:57 - INFO - training_csv_path: datasets/train.csv
2024-02-23 15:04:57 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 15:04:57 - INFO - PERIODIC_LOGGING: False
2024-02-23 15:04:57 - INFO - Folder 'models/0' already exists.
2024-02-23 15:05:02 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 15:05:03 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 15:05:03 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 15:05:05 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/generation_config.json HTTP/1.1" 404 0
2024-02-23 15:05:08 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 15:05:27 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 817, in <module>
    main()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 805, in main
    trainer.train()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 170, in train
    self.optimizer.step()
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\lr_scheduler.py", line 75, in wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\optimizer.py", line 385, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\adam.py", line 157, in step
    has_complex = self._init_group(
                  ^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\adam.py", line 113, in _init_group
    state['exp_avg_sq'] = torch.zeros_like(p, memory_format=torch.preserve_format)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 16.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. Of the allocated memory 5.23 GiB is allocated by PyTorch, and 64.84 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2024-02-23 15:05:46 - INFO - =================== New Run Started: 2024-02-23 15:05:46 ===================
2024-02-23 15:05:46 - INFO - Tarning X_Reporto Started
2024-02-23 15:05:46 - INFO - MODEL_STAGE: 3
2024-02-23 15:05:46 - INFO - DEVICE: cuda
2024-02-23 15:05:46 - INFO - CONTINUE_TRAIN: False
2024-02-23 15:05:46 - INFO - TRAIN_RPN: False
2024-02-23 15:05:46 - INFO - RUN: 0
2024-02-23 15:05:46 - INFO - EPOCHS: 5
2024-02-23 15:05:46 - INFO - BATCH_SIZE: 1
2024-02-23 15:05:46 - INFO - LM_Batch_Size: 1
2024-02-23 15:05:46 - INFO - LEARNING_RATE: 0.0001
2024-02-23 15:05:46 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 15:05:46 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 15:05:46 - INFO - DEBUG: True
2024-02-23 15:05:46 - INFO - GENERATE_REPORT: False
2024-02-23 15:05:46 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 15:05:46 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 15:05:46 - INFO - training_csv_path: datasets/train.csv
2024-02-23 15:05:46 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 15:05:46 - INFO - PERIODIC_LOGGING: False
2024-02-23 15:05:46 - INFO - Folder 'models/0' already exists.
2024-02-23 15:05:51 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 15:05:52 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 15:05:52 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/config.json HTTP/1.1" 200 0
2024-02-23 15:05:54 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/generation_config.json HTTP/1.1" 404 0
2024-02-23 15:05:57 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 15:06:14 - ERROR - An error occurred
Traceback (most recent call last):
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 817, in <module>
    main()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 805, in main
    trainer.train()
  File "D:\Engineering\Fourth_Year\First_Term\Graduation\Graduation-Project\src\x_reporto\trainer\x_reporto_trainer.py", line 170, in train
    self.optimizer.step()
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\lr_scheduler.py", line 75, in wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\optimizer.py", line 385, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\optimizer.py", line 76, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\adam.py", line 157, in step
    has_complex = self._init_group(
                  ^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\pt\Lib\site-packages\torch\optim\adam.py", line 113, in _init_group
    state['exp_avg_sq'] = torch.zeros_like(p, memory_format=torch.preserve_format)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 16.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. Of the allocated memory 5.23 GiB is allocated by PyTorch, and 72.03 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2024-02-23 15:06:46 - INFO - =================== New Run Started: 2024-02-23 15:06:46 ===================
2024-02-23 15:06:46 - INFO - Tarning X_Reporto Started
2024-02-23 15:06:46 - INFO - MODEL_STAGE: 1
2024-02-23 15:06:46 - INFO - DEVICE: cuda
2024-02-23 15:06:46 - INFO - CONTINUE_TRAIN: False
2024-02-23 15:06:46 - INFO - TRAIN_RPN: False
2024-02-23 15:06:46 - INFO - RUN: 0
2024-02-23 15:06:46 - INFO - EPOCHS: 5
2024-02-23 15:06:46 - INFO - BATCH_SIZE: 1
2024-02-23 15:06:46 - INFO - LM_Batch_Size: 1
2024-02-23 15:06:46 - INFO - LEARNING_RATE: 0.0001
2024-02-23 15:06:46 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 15:06:46 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 15:06:46 - INFO - DEBUG: True
2024-02-23 15:06:46 - INFO - GENERATE_REPORT: False
2024-02-23 15:06:46 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 15:06:46 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 15:06:46 - INFO - training_csv_path: datasets/train.csv
2024-02-23 15:06:46 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 15:06:46 - INFO - PERIODIC_LOGGING: False
2024-02-23 15:06:46 - INFO - Folder 'models/0' already exists.
2024-02-23 15:06:49 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 15:06:49 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:00:08 - INFO - =================== New Run Started: 2024-02-23 19:00:08 ===================
2024-02-23 19:00:08 - INFO - Tarning X_Reporto Started
2024-02-23 19:00:08 - INFO - MODEL_STAGE: 1
2024-02-23 19:00:08 - INFO - DEVICE: cuda
2024-02-23 19:00:08 - INFO - CONTINUE_TRAIN: False
2024-02-23 19:00:08 - INFO - TRAIN_RPN: True
2024-02-23 19:00:08 - INFO - RUN: 0
2024-02-23 19:00:08 - INFO - EPOCHS: 5
2024-02-23 19:00:08 - INFO - BATCH_SIZE: 1
2024-02-23 19:00:08 - INFO - LM_Batch_Size: 1
2024-02-23 19:00:08 - INFO - LEARNING_RATE: 0.0001
2024-02-23 19:00:08 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 19:00:08 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 19:00:08 - INFO - DEBUG: True
2024-02-23 19:00:08 - INFO - GENERATE_REPORT: False
2024-02-23 19:00:08 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 19:00:08 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 19:00:08 - INFO - training_csv_path: datasets/train.csv
2024-02-23 19:00:08 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 19:00:08 - INFO - PERIODIC_LOGGING: False
2024-02-23 19:00:08 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 19:00:08 - INFO - Folder 'models/0' already exists.
2024-02-23 19:00:08 - INFO - Folder 'check_points/0' created successfully.
2024-02-23 19:00:15 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 19:00:16 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:00:16 - INFO - Train dataset loaded
2024-02-23 19:00:16 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:00:16 - INFO - Validate dataset loaded
2024-02-23 19:00:16 - INFO - DataLoader Loaded
2024-02-23 19:00:16 - INFO - Start Training
2024-02-23 19:00:42 - DEBUG - epoch: 1, Batch 1/2 object_detector_Loss: 0.9715 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 0.9715
2024-02-23 19:00:44 - INFO - Epoch 1/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:00:45 - DEBUG - epoch: 1, Batch 2/2 object_detector_Loss: 1.1073 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.1073
2024-02-23 19:00:45 - INFO - Epoch 1/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:00:46 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 788, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 776, in main
    trainer.train()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 174, in train
    scheduler_state_dict=self.lr_scheduler.state_dict(),model_state=self.model.state_state_dict(),
                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\nn\modules\module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'XReportoV1' object has no attribute 'state_state_dict'
2024-02-23 19:01:35 - INFO - =================== New Run Started: 2024-02-23 19:01:35 ===================
2024-02-23 19:01:35 - INFO - Tarning X_Reporto Started
2024-02-23 19:01:35 - INFO - MODEL_STAGE: 1
2024-02-23 19:01:35 - INFO - DEVICE: cuda
2024-02-23 19:01:35 - INFO - CONTINUE_TRAIN: False
2024-02-23 19:01:35 - INFO - TRAIN_RPN: True
2024-02-23 19:01:35 - INFO - RUN: 0
2024-02-23 19:01:35 - INFO - EPOCHS: 5
2024-02-23 19:01:35 - INFO - BATCH_SIZE: 1
2024-02-23 19:01:35 - INFO - LM_Batch_Size: 1
2024-02-23 19:01:35 - INFO - LEARNING_RATE: 0.0001
2024-02-23 19:01:35 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 19:01:35 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 19:01:35 - INFO - DEBUG: True
2024-02-23 19:01:35 - INFO - GENERATE_REPORT: False
2024-02-23 19:01:35 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 19:01:35 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 19:01:35 - INFO - training_csv_path: datasets/train.csv
2024-02-23 19:01:35 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 19:01:35 - INFO - PERIODIC_LOGGING: False
2024-02-23 19:01:35 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 19:01:35 - INFO - Folder 'models/0' already exists.
2024-02-23 19:01:35 - INFO - Folder 'check_points/0' already exists.
2024-02-23 19:01:38 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 19:01:39 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:01:39 - INFO - Train dataset loaded
2024-02-23 19:01:40 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:01:40 - INFO - Validate dataset loaded
2024-02-23 19:01:40 - INFO - DataLoader Loaded
2024-02-23 19:01:40 - INFO - Start Training
2024-02-23 19:02:03 - DEBUG - epoch: 1, Batch 1/2 object_detector_Loss: 1.0652 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.0652
2024-02-23 19:02:05 - INFO - Epoch 1/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:02:05 - DEBUG - epoch: 1, Batch 2/2 object_detector_Loss: 0.9229 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 0.9229
2024-02-23 19:02:06 - INFO - Epoch 1/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:02:08 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 788, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 776, in main
    trainer.train()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 173, in train
    save_checkpoint(epoch=epoch,batch_index=batch_idx,optimizer_state=self.optimizer.state_dict(),
  File "E:\Graduation Project\Graduation-Project-Repo\src\utils.py", line 330, in save_checkpoint
    torch.save(checkpoint, checkpoint_path)
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Parent directory /check_points does not exist.
2024-02-23 19:03:57 - INFO - =================== New Run Started: 2024-02-23 19:03:57 ===================
2024-02-23 19:03:57 - INFO - Tarning X_Reporto Started
2024-02-23 19:03:57 - INFO - MODEL_STAGE: 1
2024-02-23 19:03:57 - INFO - DEVICE: cuda
2024-02-23 19:03:57 - INFO - CONTINUE_TRAIN: False
2024-02-23 19:03:57 - INFO - TRAIN_RPN: True
2024-02-23 19:03:57 - INFO - RUN: 0
2024-02-23 19:03:57 - INFO - EPOCHS: 5
2024-02-23 19:03:57 - INFO - BATCH_SIZE: 1
2024-02-23 19:03:57 - INFO - LM_Batch_Size: 1
2024-02-23 19:03:57 - INFO - LEARNING_RATE: 0.0001
2024-02-23 19:03:57 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 19:03:57 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 19:03:57 - INFO - DEBUG: True
2024-02-23 19:03:57 - INFO - GENERATE_REPORT: False
2024-02-23 19:03:57 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 19:03:57 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 19:03:57 - INFO - training_csv_path: datasets/train.csv
2024-02-23 19:03:57 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 19:03:57 - INFO - PERIODIC_LOGGING: False
2024-02-23 19:03:57 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 19:03:57 - INFO - Folder 'models/0' already exists.
2024-02-23 19:03:57 - INFO - Folder 'check_points/0' already exists.
2024-02-23 19:04:00 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 19:04:01 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:04:01 - INFO - Train dataset loaded
2024-02-23 19:04:02 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:04:02 - INFO - Validate dataset loaded
2024-02-23 19:04:02 - INFO - DataLoader Loaded
2024-02-23 19:04:02 - INFO - Start Training
2024-02-23 19:04:23 - DEBUG - epoch: 1, Batch 1/2 object_detector_Loss: 1.0408 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.0408
2024-02-23 19:04:24 - INFO - Epoch 1/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:04:25 - DEBUG - epoch: 1, Batch 2/2 object_detector_Loss: 1.1184 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.1184
2024-02-23 19:04:25 - INFO - Epoch 1/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:04:28 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 788, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 776, in main
    trainer.train()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 173, in train
    save_checkpoint(epoch=epoch,batch_index=batch_idx,optimizer_state=self.optimizer.state_dict(),
  File "E:\Graduation Project\Graduation-Project-Repo\src\utils.py", line 331, in save_checkpoint
    torch.save(checkpoint, checkpoint_path)
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Parent directory /check_points does not exist.
2024-02-23 19:05:03 - INFO - =================== New Run Started: 2024-02-23 19:05:03 ===================
2024-02-23 19:05:03 - INFO - Tarning X_Reporto Started
2024-02-23 19:05:03 - INFO - MODEL_STAGE: 1
2024-02-23 19:05:03 - INFO - DEVICE: cuda
2024-02-23 19:05:03 - INFO - CONTINUE_TRAIN: False
2024-02-23 19:05:03 - INFO - TRAIN_RPN: True
2024-02-23 19:05:03 - INFO - RUN: 0
2024-02-23 19:05:03 - INFO - EPOCHS: 5
2024-02-23 19:05:03 - INFO - BATCH_SIZE: 1
2024-02-23 19:05:03 - INFO - LM_Batch_Size: 1
2024-02-23 19:05:03 - INFO - LEARNING_RATE: 0.0001
2024-02-23 19:05:03 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 19:05:03 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 19:05:03 - INFO - DEBUG: True
2024-02-23 19:05:03 - INFO - GENERATE_REPORT: False
2024-02-23 19:05:03 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 19:05:03 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 19:05:03 - INFO - training_csv_path: datasets/train.csv
2024-02-23 19:05:03 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 19:05:03 - INFO - PERIODIC_LOGGING: False
2024-02-23 19:05:03 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 19:05:03 - INFO - Folder 'models/0' already exists.
2024-02-23 19:05:03 - INFO - Folder 'check_points/0' already exists.
2024-02-23 19:05:06 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 19:05:07 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:05:07 - INFO - Train dataset loaded
2024-02-23 19:05:08 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:05:08 - INFO - Validate dataset loaded
2024-02-23 19:05:08 - INFO - DataLoader Loaded
2024-02-23 19:05:08 - INFO - Start Training
2024-02-23 19:05:26 - DEBUG - epoch: 1, Batch 1/2 object_detector_Loss: 1.0613 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.0613
2024-02-23 19:05:27 - INFO - Epoch 1/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:05:27 - DEBUG - epoch: 1, Batch 2/2 object_detector_Loss: 1.1502 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.1502
2024-02-23 19:05:27 - INFO - Epoch 1/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:05:30 - ERROR - An error occurred
Traceback (most recent call last):
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 788, in <module>
    main()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 776, in main
    trainer.train()
  File "E:\Graduation Project\Graduation-Project-Repo\src\x_reporto\trainer\x_reporto_trainer.py", line 173, in train
    save_checkpoint(epoch=epoch,batch_index=batch_idx,optimizer_state=self.optimizer.state_dict(),
  File "E:\Graduation Project\Graduation-Project-Repo\src\utils.py", line 330, in save_checkpoint
    torch.save(checkpoint, checkpoint_path)
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Roaming\Python\Python311\site-packages\torch\serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Parent directory /check_points/0 does not exist.
2024-02-23 19:06:12 - INFO - =================== New Run Started: 2024-02-23 19:06:12 ===================
2024-02-23 19:06:12 - INFO - Tarning X_Reporto Started
2024-02-23 19:06:12 - INFO - MODEL_STAGE: 1
2024-02-23 19:06:12 - INFO - DEVICE: cuda
2024-02-23 19:06:12 - INFO - CONTINUE_TRAIN: False
2024-02-23 19:06:12 - INFO - TRAIN_RPN: True
2024-02-23 19:06:12 - INFO - RUN: 0
2024-02-23 19:06:12 - INFO - EPOCHS: 5
2024-02-23 19:06:12 - INFO - BATCH_SIZE: 1
2024-02-23 19:06:12 - INFO - LM_Batch_Size: 1
2024-02-23 19:06:12 - INFO - LEARNING_RATE: 0.0001
2024-02-23 19:06:12 - INFO - SCHEDULAR_STEP_SIZE: 1500
2024-02-23 19:06:12 - INFO - SCHEDULAR_GAMMA: 0.9
2024-02-23 19:06:12 - INFO - DEBUG: True
2024-02-23 19:06:12 - INFO - GENERATE_REPORT: False
2024-02-23 19:06:12 - INFO - ABNORMAL_CLASSIFIER_POS_WEIGHT: 6.0
2024-02-23 19:06:12 - INFO - REGION_SELECTION_CLASSIFIER_POS_WEIGHT: 2.24
2024-02-23 19:06:12 - INFO - training_csv_path: datasets/train.csv
2024-02-23 19:06:12 - INFO - validation_csv_path: datasets/train.csv
2024-02-23 19:06:12 - INFO - PERIODIC_LOGGING: False
2024-02-23 19:06:12 - INFO - CHECKPOINT_EVERY_N: 2
2024-02-23 19:06:12 - INFO - Folder 'models/0' already exists.
2024-02-23 19:06:12 - INFO - Folder 'check_points/0' already exists.
2024-02-23 19:06:15 - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2024-02-23 19:06:16 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:06:16 - INFO - Train dataset loaded
2024-02-23 19:06:16 - DEBUG - https://huggingface.co:443 "HEAD /healx/gpt-2-pubmed-medium/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2024-02-23 19:06:17 - INFO - Validate dataset loaded
2024-02-23 19:06:17 - INFO - DataLoader Loaded
2024-02-23 19:06:17 - INFO - Start Training
2024-02-23 19:06:31 - DEBUG - epoch: 1, Batch 1/2 object_detector_Loss: 1.0504 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.0504
2024-02-23 19:06:32 - INFO - Epoch 1/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:06:33 - DEBUG - epoch: 1, Batch 2/2 object_detector_Loss: 1.0218 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.0218
2024-02-23 19:06:33 - INFO - Epoch 1/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:06:46 - INFO - Saved Check point atcheck_points/0/checkpoint.pth
2024-02-23 19:06:47 - INFO - Saving object_detector_rpn_epoch 1
2024-02-23 19:07:05 - INFO - best epoch: 1, best epoch loss: 2.0722
2024-02-23 19:07:20 - DEBUG - epoch: 2, Batch 1/2 object_detector_Loss: 0.9793 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 0.9793
2024-02-23 19:07:20 - INFO - Epoch 2/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:07:20 - DEBUG - epoch: 2, Batch 2/2 object_detector_Loss: 0.8854 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 0.8854
2024-02-23 19:07:20 - INFO - Epoch 2/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:07:36 - INFO - Saved Check point atcheck_points/0/checkpoint.pth
2024-02-23 19:07:37 - INFO - Saving object_detector_rpn_epoch 2
2024-02-23 19:07:54 - INFO - best epoch: 2, best epoch loss: 1.8648
2024-02-23 19:08:08 - DEBUG - epoch: 3, Batch 1/2 object_detector_Loss: 1.0083 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 1.0083
2024-02-23 19:08:08 - INFO - Epoch 3/5, Batch 1/2, Learning Rate: 0.0001000000
2024-02-23 19:08:08 - DEBUG - epoch: 3, Batch 2/2 object_detector_Loss: 0.8551 selection_classifier_Loss: 0.0000 abnormal_classifier_Loss: 0.0000  total_Loss: 0.8551
2024-02-23 19:08:08 - INFO - Epoch 3/5, Batch 2/2, Learning Rate: 0.0001000000
2024-02-23 19:08:21 - INFO - Saved Check point atcheck_points/0/checkpoint.pth
2024-02-23 19:08:23 - INFO - Saving object_detector_rpn_epoch 3
2024-02-23 19:08:43 - INFO - best epoch: 3, best epoch loss: 1.8634
